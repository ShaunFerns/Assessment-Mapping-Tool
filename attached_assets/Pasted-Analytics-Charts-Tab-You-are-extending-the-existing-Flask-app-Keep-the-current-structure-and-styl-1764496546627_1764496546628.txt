Analytics” Charts Tab

You are extending the existing Flask app. Keep the current structure and styling (TU Dublin navy/teal, no JS frameworks apart from Plotly).

Add a new “Analytics” tab under Visualisations, beside the existing Triangle and Assessment Heatmap views.

All charts should be generated using Plotly (Python + Plotly.js). Use simple, clean layouts.

1. Dependencies

Update requirements.txt to include Plotly:

plotly==5.23.0


In base.html (or the analytics template), load Plotly JS from CDN in the <head>:

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

2. Navigation updates

In the main nav (base.html), keep existing items.

On the Visualisations landing page (currently /visualisations), update the UI so it shows three main buttons/links:

“Triangle timeline view” → /visual/triangle

“Assessment heatmap view” → /visual/heatmap

New: “Analytics dashboard” → /visual/analytics

Use the same TU Dublin navy/teal button styling as elsewhere.

3. New route and template

Create a new route in app.py:

@app.route("/visual/analytics")
def visual_analytics():
    # Use global programme, modules, assessments
    if not programme or not modules or not assessments:
        # render template with a friendly message if data is missing
        return render_template("visual_analytics.html", no_data=True)

    # Build all data structures for charts here
    # 1) Weekly load (sum of weight per week)
    # 2) Assessment type distribution
    # 3) Module assessment profiles
    # 4) GA coverage (People/Planet/Partnership)
    # 5) Assessment stress map

    # WEEKLY LOAD
    weeks = list(range(1, programme["weeks"] + 1))
    weekly_load = [0] * programme["weeks"]
    for a in assessments:
        w = a["week"]
        if 1 <= w <= programme["weeks"]:
            weekly_load[w - 1] += a["weight"]

    # TYPE DISTRIBUTION (total weighting per type)
    type_labels = ["Delivery", "Presentation", "Exam", "Report", "Case Study"]
    type_map = {t.lower(): 0 for t in type_labels}
    for a in assessments:
        key = a["atype"].lower()
        if key in type_map:
            type_map[key] += a["weight"]
    type_values = [type_map[t.lower()] for t in type_labels]

    # MODULE PROFILES (count + total weight)
    module_labels = [m["code"] for m in modules]
    module_total_weight = [0] * len(modules)
    module_assessment_count = [0] * len(modules)
    module_index = {m["id"]: idx for idx, m in enumerate(modules)}
    for a in assessments:
        idx = module_index.get(a["module_id"])
        if idx is not None:
            module_total_weight[idx] += a["weight"]
            module_assessment_count[idx] += 1

    # GA COVERAGE (People / Planet / Partnership – case-insensitive match)
    ga_labels = ["People", "Planet", "Partnership"]
    ga_totals = [0, 0, 0]
    for a in assessments:
        ga = (a.get("ga") or "").strip().lower()
        for i, label in enumerate(ga_labels):
            if label.lower() in ga:
                ga_totals[i] += a["weight"]

    # STRESS MAP – copy of weekly_load plus colour bands will be determined in JS
    stress_values = weekly_load[:]  # same as weekly load

    return render_template(
        "visual_analytics.html",
        no_data=False,
        weeks=weeks,
        weekly_load=weekly_load,
        type_labels=type_labels,
        type_values=type_values,
        module_labels=module_labels,
        module_total_weight=module_total_weight,
        module_assessment_count=module_assessment_count,
        ga_labels=ga_labels,
        ga_totals=ga_totals,
        stress_values=stress_values,
    )

4. templates/visual_analytics.html

Create a new template that extends base.html:

If no_data is True, show a short message:

“Add a programme, modules and at least one assessment to see analytics.”

Otherwise, show a two-column grid (or stacked on small screens) with five chart containers:

Weekly assessment load

Assessment type balance

Module assessment profiles

Graduate Attribute coverage (radar)

Assessment stress map

Each chart should have:

A heading (<h2> or <h3>)

A <div> with an ID for Plotly to target.

Example skeleton:

{% extends "base.html" %}
{% block content %}
<div class="page-header">
  <h1>Analytics dashboard</h1>
  <p class="subtitle">Programme-level assessment insights</p>
</div>

{% if no_data %}
  <div class="alert alert-info">
    Please define a programme, add modules, and create at least one assessment to view analytics.
  </div>
{% else %}
  <div class="analytics-grid">
    <div class="chart-card">
      <h3>Weekly assessment load (total weighting per week)</h3>
      <div id="chart-weekly-load"></div>
    </div>

    <div class="chart-card">
      <h3>Assessment type balance</h3>
      <div id="chart-type-balance"></div>
    </div>

    <div class="chart-card">
      <h3>Module assessment profiles</h3>
      <div id="chart-module-profile"></div>
    </div>

    <div class="chart-card">
      <h3>Graduate Attribute coverage</h3>
      <div id="chart-ga-coverage"></div>
    </div>

    <div class="chart-card">
      <h3>Assessment stress map</h3>
      <div id="chart-stress-map"></div>
    </div>
  </div>

  <script>
    // Data passed from Flask
    const weeks = {{ weeks|tojson }};
    const weeklyLoad = {{ weekly_load|tojson }};
    const typeLabels = {{ type_labels|tojson }};
    const typeValues = {{ type_values|tojson }};
    const moduleLabels = {{ module_labels|tojson }};
    const moduleTotalWeight = {{ module_total_weight|tojson }};
    const moduleAssessmentCount = {{ module_assessment_count|tojson }};
    const gaLabels = {{ ga_labels|tojson }};
    const gaTotals = {{ ga_totals|tojson }};
    const stressValues = {{ stress_values|tojson }};

    // 1) Weekly assessment load (bar chart)
    Plotly.newPlot("chart-weekly-load", [{
      x: weeks,
      y: weeklyLoad,
      type: "bar"
    }], {
      margin: {t: 30},
      xaxis: {title: "Week"},
      yaxis: {title: "Total weighting (%)"}
    });

    // 2) Assessment type balance (pie chart)
    Plotly.newPlot("chart-type-balance", [{
      labels: typeLabels,
      values: typeValues,
      type: "pie",
      hole: 0.3
    }], {
      margin: {t: 30}
    });

    // 3) Module assessment profiles (dual-axis bar: total weight and count)
    Plotly.newPlot("chart-module-profile", [
      {
        x: moduleLabels,
        y: moduleTotalWeight,
        name: "Total weighting",
        type: "bar"
      },
      {
        x: moduleLabels,
        y: moduleAssessmentCount,
        name: "Number of assessments",
        type: "bar",
        yaxis: "y2"
      }
    ], {
      barmode: "group",
      margin: {t: 30},
      xaxis: {title: "Module"},
      yaxis: {title: "Total weighting (%)"},
      yaxis2: {
        title: "Count",
        overlaying: "y",
        side: "right"
      }
    });

    // 4) GA coverage (radar chart)
    Plotly.newPlot("chart-ga-coverage", [{
      type: "scatterpolar",
      r: gaTotals,
      theta: gaLabels,
      fill: "toself"
    }], {
      polar: {radialaxis: {visible: true, range: [0, Math.max(...gaTotals, 10)]}},
      margin: {t: 30}
    });

    // 5) Assessment stress map (colour-coded bar)
    const stressColors = stressValues.map(v => {
      if (v <= 30) return "rgba(39, 174, 96, 0.8)";      // green low
      if (v <= 60) return "rgba(241, 196, 15, 0.9)";      // amber medium
      return "rgba(231, 76, 60, 0.9)";                    // red high
    });

    Plotly.newPlot("chart-stress-map", [{
      x: weeks,
      y: stressValues,
      type: "bar",
      marker: {color: stressColors}
    }], {
      margin: {t: 30},
      xaxis: {title: "Week"},
      yaxis: {title: "Total weighting (%)"},
    });
  </script>
{% endif %}
{% endblock %}

5. Styling (CSS)

In static/css/style.css, add:

.analytics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 1.5rem;
  margin-top: 1.5rem;
}

.chart-card {
  background: #ffffff;
  border-radius: 10px;
  padding: 1rem 1.25rem;
  box-shadow: 0 2px 6px rgba(0,0,0,0.06);
}

.chart-card h3 {
  margin-top: 0;
  margin-bottom: 0.75rem;
  color: var(--tu-navy);
}

.page-header {
  margin-bottom: 1rem;
}

.page-header h1 {
  margin-bottom: 0.25rem;
  color: var(--tu-navy);
}

.subtitle {
  color: #666;
}


This will present the five charts as clean cards under the Analytics tab.